# ç­”ç–‘è¯¾å ‚ï¼ˆä¸€ï¼‰ï½œç¬¬ä¸€ç« RuståŸºç¡€ç¯‡æ€è€ƒé¢˜ç­”æ¡ˆ
ä½ å¥½ï¼Œæˆ‘æ˜¯Mikeã€‚

æ­å–œä½ å­¦å®Œå‰ä¸¤ç« çš„å†…å®¹äº†ï¼ŒåŸºç¡€ç¯‡å’Œè¿›é˜¶ç¯‡ä¸€å…±æœ‰20è®²ï¼Œæ¯ä¸€è®²çš„å†…å®¹éƒ½å¾ˆé‡è¦ï¼Œç®—æ˜¯ä½ å…¥é—¨Rustçš„é‡è¦åŸºç¡€ï¼Œæ‰€ä»¥ä¸€å®šè¦å¤šè¯»å‡ éï¼Œäº‰å–å­¦é€ã€‚ä¸ºäº†è®©ä½ å­¦æ€ç»“åˆï¼Œæˆ‘ä»¬åœ¨æ¯èŠ‚è¯¾çš„æœ€åè®¾è®¡äº†å¯¹åº”çš„æ€è€ƒé¢˜ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬å°±æ¥å¤„ç†è¿™äº›é—®é¢˜ã€‚

æˆ‘ä¹Ÿçœ‹åˆ°å¾ˆå¤šåŒå­¦åœ¨è¯¾ç¨‹çš„åé¢å›ç­”äº†è¿™äº›é—®é¢˜ï¼Œæ­¤å¤–è¿˜æœ‰ä¸€äº›å…¶ä»–çš„é—®é¢˜ï¼Œæå¾—ä¹Ÿå¾ˆç²¾å½©ï¼Œæ‰€ä»¥æˆ‘æŒ‘å‡ºä¸€å¹¶æ”¾åœ¨è¿™é‡Œï¼Œå¸Œæœ›èƒ½ä¸ºä½ è§£æƒ‘ï¼Œå¯¹ä½ æœ‰æ‰€å¯å‘ï¼Œè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬é©¬ä¸Šå¼€å§‹å§ï¼

åšå®Œæ€è€ƒé¢˜å†æ¥çœ‹ç­”æ¡ˆä¼šæ›´æœ‰æ”¶è·ã€‚

## **åŸºç¡€ç¯‡**

### [01ï½œå¿«é€Ÿå…¥é—¨ï¼šRust ä¸­æœ‰å“ªäº›ä½ ä¸å¾—ä¸äº†è§£çš„åŸºç¡€è¯­æ³•ï¼Ÿ](https://time.geekbang.org/column/article/718865?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

- Rust ä¸­èƒ½å¦å®ç°ç±»ä¼¼ JS ä¸­çš„ number è¿™ç§é€šç”¨çš„æ•°å­—ç±»å‹å‘¢ï¼Ÿ
- Rust ä¸­èƒ½å¦å®ç° Python ä¸­é‚£ç§æ— é™å¤§å°çš„æ•°å­—ç±»å‹å‘¢ï¼Ÿ

#### ç­”æ¡ˆ

åœ¨ Rust ä¸­ï¼Œæœ‰å¤šç§æ•°å­—ç±»å‹ï¼ŒåŒ…æ‹¬æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•°ç­‰ã€‚å’Œ JS ä¸­çš„ number ç±»å‹ç›¸ä¼¼ï¼ŒRust ä¸­çš„æ•°å­—ç±»å‹ä¹Ÿæ”¯æŒåŸºæœ¬çš„æ•°å­¦è¿ç®—ï¼Œä¾‹å¦‚åŠ å‡ä¹˜é™¤å’Œå–æ¨¡ç­‰ã€‚ä¸è¿‡ï¼Œå’Œ JS çš„ number ä¸åŒï¼ŒRust çš„æ•°å­—ç±»å‹éƒ½å…·æœ‰å›ºå®šçš„ä½æ•°ï¼Œè¿™æ„å‘³ç€ä¸åŒçš„æ•°å­—ç±»å‹æœ‰ä¸åŒçš„å–å€¼èŒƒå›´ã€‚

æ­¤å¤–ï¼ŒRust ä¸­çš„æ•°å€¼ç±»å‹éœ€è¦åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šå®ƒä»¬çš„ç±»å‹å’Œå¤§å°ï¼Œè¿™äº›ç±»å‹å¯ä»¥é€šè¿‡ä½¿ç”¨ Rust å†…ç½®çš„ç±»å‹æ³¨è§£ï¼Œæˆ–æ˜¯çµæ´»çš„å°æ•°ç‚¹å’Œåç¼€è¡¨ç¤ºæ³•æ¥å£°æ˜ã€‚è€Œ crates.io ä¸Šæœ‰ num crate å¯ä»¥ç”¨æ¥è¡¨ç¤ºé€šç”¨çš„æ•°å­—ç±»å‹ï¼Œå…·ä½“æ˜¯é€šè¿‡traitæœºåˆ¶æ¥å®ç°çš„ã€‚

å…³äºå®ç° Python ä¸­æ— é™å¤§å°çš„æ•°å­—ç±»å‹ï¼ŒRust ä¸ç›´æ¥æ”¯æŒè¿™ä¸ªç‰¹æ€§ï¼Œä½†å¯ä»¥é€šè¿‡ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ç°ã€‚å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“åŒ…æ‹¬ rug å’Œ num-bigint ç­‰ï¼Œå®ƒä»¬æä¾›äº†å®ç°é«˜ç²¾åº¦è®¡ç®—çš„æ•°æ®ç±»å‹å’Œå‡½æ•°ï¼Œä½¿ Rust å¯ä»¥å¤„ç†æ›´å¤§çš„æ•´æ•°å’Œæµ®ç‚¹æ•°ã€‚è¿™äº›åº“é‡‡ç”¨çš„æ˜¯ç±»ä¼¼äº Python çš„åŠ¨æ€å†…å­˜åˆ†é…å’Œå­˜å‚¨æœºåˆ¶ï¼Œèƒ½å¤Ÿè¿›è¡Œå‡ ä¹æ— é™å¤§å°çš„æ•°å­—è®¡ç®—ã€‚

### [02ï½œæ‰€æœ‰æƒï¼ˆä¸Šï¼‰ï¼šRust å¦‚ä½•ç®¡ç†ç¨‹åºä¸­çš„èµ„æºï¼Ÿ](https://time.geekbang.org/column/article/718916?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

1. ä¸‹é¢çš„ç¤ºä¾‹å°†è¾“å‡ºä»€ä¹ˆï¼Ÿ

```plain
fn main() {
Â  Â  let s = "I am a superman.".to_string();

Â  Â  for i in 1..10 {
Â  Â  Â  Â  let tmp_s = s;
Â  Â  Â  Â  println!("s is {}", tmp_s);
Â  Â  }
}

```

1. ä¸€ä¸ªç”±å›ºå®šå°ºå¯¸ç±»å‹ç»„æˆçš„ç»“æ„ä½“å˜é‡ï¼Œå¦‚ä¸‹é¢ç¤ºä¾‹ä¸­çš„Pointç±»å‹ï¼Œåœ¨èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œé‡‡ç”¨çš„ç§»åŠ¨æ–¹å¼è¿˜æ˜¯å¤åˆ¶æ–¹å¼ï¼Ÿ

```plain
struct Point {
  x: i64,
  y: i64,
  z: i64
}

```

#### ç­”æ¡ˆ

1. æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå¯ä»¥å°†ç¬¬ 5 è¡Œä»£ç ä¿®æ”¹ä¸ºï¼šlet tmp\_s = s.clone();ã€‚

ä¿®æ”¹åå¦‚ä¸‹ï¼š

```plain
fn main() {
    let s = "I am a superman.".to_string();

    for _ in 1..10 {
        let tmp_s = s.clone();
        println!("s is {}", tmp_s);
    }
}

```

1. ç”±äº Point æ²¡æœ‰å®ç° Copy traitï¼Œæ‰€ä»¥åœ¨èµ‹å€¼è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿ Moveã€‚å¦‚æœç»“æ„ä½“å®ç°äº† Copy traitï¼Œåˆ™ä¼šè¿›è¡Œå¤åˆ¶è€Œä¸æ˜¯ç§»åŠ¨ã€‚

ç­”æ¡ˆæ¥è‡ªäºŒå¤•Thrower å’Œ Forest

### [03ï½œæ‰€æœ‰æƒï¼ˆä¸‹ï¼‰ï¼šRust ä¸­å€Ÿç”¨ä¸å¼•ç”¨çš„è§„åˆ™æ˜¯æ€æ ·çš„ï¼Ÿ](https://time.geekbang.org/column/article/720128?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

1. è¯·æ€è€ƒï¼Œä¸ºä½•åœ¨ä¸å¯å˜å¼•ç”¨å­˜åœ¨çš„æƒ…å†µä¸‹ï¼ˆåªæ˜¯è¯»æ“ä½œï¼‰ï¼ŒåŸæ‰€æœ‰æƒå˜é‡ä¹Ÿæ— æ³•å†™å…¥ï¼Ÿ

```plain
fn main() {
Â  Â  let mut a: u32 = 10;
Â  Â  let b = &a;
Â  Â  a = 20;

Â  Â  println!("{}", b);
}

```

1. è¯·å›ç­”ï¼Œå¯å˜å¼•ç”¨å¤åˆ¶çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆä¸å…è®¸copyï¼Œè€Œæ˜¯moveï¼Ÿ

#### ç­”æ¡ˆ

1. ä¸å¯å˜å¼•ç”¨çš„ä½œç”¨åŸŸè·¨è¶Šäº†æ‰€æœ‰æƒå˜é‡çš„å†™å…¥è¿‡ç¨‹ï¼Œæ„å‘³ç€åŒä¸€ä¸ªä½œç”¨åŸŸåŒæ—¶å­˜åœ¨å¯å˜å¼•ç”¨å’Œä¸å¯å˜å¼•ç”¨ï¼Œç¼–è¯‘å™¨ä¸ºäº†é˜²æ­¢è¯»å–é”™è¯¯ï¼Œä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚å¯ä»¥æŠŠa = 20æ”¾åˆ°å¼•ç”¨ä¹‹å‰ï¼Œå³å¯ç¼–è¯‘é€šè¿‡ã€‚

2. å¯å˜å¼•ç”¨å¦‚æœå¯ä»¥Copyï¼Œå°±è¿åäº†å¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨çš„è§„åˆ™ï¼Œå› æ­¤åªèƒ½Moveã€‚


ä¸å¯å˜å€Ÿç”¨ï¼Œä»å­—é¢ç†è§£å°±æ˜¯å€Ÿå‡ºå»äº†å°±ä¸èƒ½å˜äº†ï¼Œæ‰€ä»¥æ—¢ç„¶ä¿è¯ä¸å˜äº†ï¼Œé‚£è¿™æ ·çš„å€Ÿç”¨å½“ç„¶å¯ä»¥è¢«å€Ÿå‡ºå»Næ¬¡ï¼ˆåŸå˜é‡ä¸å¯å˜æ˜¯åªé™äºåœ¨å€Ÿå‡ºå»çš„å˜é‡çš„æœ‰æ•ˆç”Ÿå‘½å‘¨æœŸå†…ï¼‰ã€‚å¯å˜å€Ÿç”¨å°±æ˜¯å€Ÿå‡ºå»éšæ—¶æœ‰è¢«æ”¹å˜çš„å¯èƒ½ï¼Œåœ¨åŒä¸€ç”Ÿå‘½å‘¨æœŸå†…å€Ÿå‡ºå»å¤šæ¬¡ï¼Œæœ‰ä¸ç¡®å®šæ€§çš„è¢«æ”¹å˜çš„é£é™©ï¼Œå°¤å…¶åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥å°±åªè®©ä½ å€Ÿå‡ºå»ä¸€æ¬¡ï¼Œæ—¢ç„¶å­˜åœ¨æœ‰ä¸ç¡®å®šæ€§çš„è¢«ä¿®æ”¹çš„å¯èƒ½ï¼Œé‚£è¿™ä¸ªæ—¶æœŸè‚¯å®šå°±ä¸ä¼šè®©ä½ å†æœ‰ä¸å¯ä»¥å˜å€Ÿç”¨äº†ï¼ˆå› ä¸ºéšæ—¶ä¼šæ”¹å˜äº†ï¼Œä¸å¯å˜å€Ÿç”¨æœ¬èº«ä¹Ÿå°±ä¸æˆç«‹äº†ï¼‰ã€‚Rustè¿™ä¸ªé€»è¾‘çœ‹ä¼¼å¾ˆç¹æ‚ï¼Œå®åˆ™é€»è¾‘ç¯ç¯ç›¸æ‰£æ¸…æ™°å¾ˆç¬¦åˆå¸¸è§„ã€‚

ç­”æ¡ˆæ¥è‡ªAndylingeå’ŒCitroen

### [04ï½œå­—ç¬¦ä¸²ï¼šå¯¹å·å…¥åº§ï¼Œå­—ç¬¦ä¸²å…¶å®æ²¡é‚£ä¹ˆå¯æ€•ï¼](https://time.geekbang.org/column/article/720426?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

`chars` å‡½æ•°æ˜¯å®šä¹‰åœ¨ str ä¸Šçš„ï¼Œä¸ºä»€ä¹ˆ String ç±»å‹èƒ½ç›´æ¥è°ƒç”¨ str ä¸Šå®šä¹‰çš„æ–¹æ³•ï¼Ÿå®é™…ä¸Š str ä¸Šæ‰€æœ‰çš„æ–¹æ³•ï¼ŒString éƒ½èƒ½è°ƒç”¨ï¼Œè¯·é—®è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

#### ç­”æ¡ˆ

å› æ­¤åœ¨Stringä¸Šå®ç°äº†Deref traitï¼Œtargetä¸ºstrã€‚

å¦å¤–è¡¥å……ä¸€äº›å­—ç¬¦ä¸²ç›¸å…³çŸ¥è¯†ç‚¹ã€‚

Rustä¸­ `char` æ˜¯ç”¨äºå­˜æ”¾unicodeå•ä¸ªå­—ç¬¦çš„ç±»å‹ï¼ˆå›ºå®š4ä¸ªå­—èŠ‚ï¼‰ã€‚Stringç±»å‹åªèƒ½æ”¾åœ¨å †ä¸Šï¼Œé€šè¿‡å¼•ç”¨æ‰€æœ‰æƒçš„å½¢å¼å’Œå˜é‡ç»‘å®šï¼Œå®ƒçš„å­˜å‚¨æ–¹å¼ä¸æ˜¯ç®€å•çš„charæ•°ç»„ï¼Œè€Œæ˜¯utf8ç¼–ç çš„å­—èŠ‚åºåˆ—ï¼Œæ‰€ä»¥å•ç‹¬å–è¿™ä¸ªåºåˆ—çš„æŸä¸€æ®µåˆ‡ç‰‡ï¼Œä¸ä¸€å®šèƒ½è§£æå‡ºå…·ä½“çš„å­—ç¬¦ï¼ˆç¨‹åºé‡Œçš„ `String[a..b]`ï¼Œè¿™é‡Œçš„aå’Œbå·²ç»æ˜¯ç»è¿‡ç‰¹æ®Šå¤„ç†çš„ä¿è¯æˆªå–çš„æœ‰æ•ˆæ€§ï¼‰ã€‚

```plain
fn main() {
    let s = "abcdefghijk".to_string();
    let a = &s[..5];

    let s = "æˆ‘çˆ±ä¸­å›½".to_string();
    let a = &s[..5];
}
     Running `target/debug/playground`
thread 'main' panicked at src/main.rs:7:15:
byte index 5 is not a char boundary; it is inside 'çˆ±' (bytes 3..6) of `æˆ‘çˆ±ä¸­å›½`

```

å¦‚æœèƒ½å–å¾—æœ‰æ•ˆçš„åºåˆ—ç‰‡æ®µé‚£å°±æ˜¯strç±»å‹ï¼Œä½†æ˜¯ç¨‹åºé‡Œå‡¡æ˜¯ç”¨åˆ°ç»‘å®šstrç±»å‹å˜é‡çš„åœ°æ–¹ï¼Œåˆ™å¿…é¡»éƒ½æ˜¯å¼•ç”¨å½¢å¼å­˜åœ¨çš„ï¼ˆ&strï¼‰ï¼Œå› ä¸ºstræ˜¯å¼•ç”¨çš„åŸå§‹ç‰‡æ®µçš„é‚£æ®µçœŸå®æ•°æ®ï¼Œè€Œ&strç±»å‹æ˜¯ä¸€ä¸ªFatPointerï¼Œå®ƒåŒ…æ‹¬å¼•ç”¨ç›®æ ‡çš„èµ·å§‹åœ°å€å’Œé•¿åº¦ï¼Œæ‰€ä»¥strå’Œ&stræ˜¯å®Œå…¨ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚

u8å°±æ˜¯ä¸€ä¸ªå­˜å‚¨0åˆ°255å¤§å°çš„ç±»å‹ï¼Œå› ä¸ºä¸€ä¸ªå­—èŠ‚å°±æ˜¯8ä½ï¼Œæ‰€ä»¥\[u8, N\]å¯ä»¥çœ‹åšæ˜¯ç¨‹åºçš„ä»»ä½•ç±»å‹æ•°æ®çš„äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ã€‚

ç­”æ¡ˆæ¥è‡ª Citroen

### [05ï½œå¤åˆç±»å‹ï¼ˆä¸Šï¼‰ï¼šç»“æ„ä½“ä¸é¢å‘å¯¹è±¡ç‰¹æ€§](https://time.geekbang.org/column/article/720991?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

å¯ä»¥ç»™ i8 ç±»å‹åš impl å—ï¼Ÿ

#### ç­”æ¡ˆ

åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•å®ç°implï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ traitç»™åŸºæœ¬æ•°æ®ç±»å‹æ·»åŠ æ“ä½œçš„æ–¹å¼æ¥å®ç°ã€‚

```plain
trait Operate {
  fn plus(self) -> Self;
}

impl Operate for i8 {
    fn plus(self) -> Self {
        self + self
    }
}

fn main() {
    let  a = 1i8;
    println!("{}",a.plus());
}

```

å¦å¤–å¯ä»¥ç”¨newtypeæ¨¡å¼å¯¹ `i8` å°è£…ä¸€ä¸‹ï¼Œå†implã€‚

ç­”æ¡ˆæ¥è‡ªä¸‹é›¨å¤©å’Œçº¦ä¹¦äºš

### [06ï½œå¤åˆç±»å‹ï¼ˆä¸‹ï¼‰ï¼šæšä¸¾ä¸æ¨¡å¼åŒ¹é…](https://time.geekbang.org/column/article/720999?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

match è¡¨è¾¾å¼çš„å„ä¸ªåˆ†æ”¯ä¸­ï¼Œå¦‚æœæœ‰ä¸åŒçš„è¿”å›ç±»å‹çš„æƒ…å†µï¼Œåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿ

#### ç­”æ¡ˆ

ä½œä¸ºé™æ€ç±»å‹è¯­è¨€ï¼Œmatch è¿”å›çš„ç±»å‹å¿…é¡»åœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šï¼Œä¹Ÿå°±æ„å‘³ç€ match å¿…é¡»è¿”å›ç›¸åŒçš„ç±»å‹ã€‚åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå¦‚æœè¦è¿”å›ä¸åŒçš„ç±»å‹ï¼Œé‚£ä¹ˆåˆ‡å…¥ç‚¹å°±åªèƒ½æ˜¯ï¼šâ€œè¿”å›åŒä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯è¿™ä¸ªç±»å‹èƒ½è¡¨ç¤ºï¼ˆæ‰¿è½½ï¼‰ä¸åŒçš„ç±»å‹â€ï¼Œé‚£å°±åªèƒ½æ˜¯æœ¬èŠ‚è¯¾è®²çš„æšä¸¾ enum äº†ã€‚

```rust
enum Number {
    Int(i32),
    Float(f64),
    None
}

fn get_number(condition: i32) -> Number {
    match condition {
        1 => Number::Int(10),
        2 => Number::Float(3.14),
        _ => Number::None
    }
}

fn main() {
    let value = get_number(1);
    match value {
        Number::Int(i) => println!("int {}", i),
        Number::Float(f) => println!("float {}", f),
        Number::None => println!("not number"),
    }

    let value = get_number(2);
    match value {
        Number::Int(i) => println!("int {}", i),
        Number::Float(f) => println!("float {}", f),
        Number::None => println!("not number"),
    }

    let value = get_number(3);
    match value {
        Number::Int(i) => println!("int {}", i),
        Number::Float(f) => println!("float {}", f),
        Number::None => println!("not number"),
    }
}

```

ç­”æ¡ˆæ¥è‡ª-Hedon ğŸ­

### [07ï½œç±»å‹ä¸ç±»å‹å‚æ•°ï¼šå¦‚ä½•ç»™ Rust å°åŠ©æ‰‹æä¾›æ›´å¤šä¿¡æ¯ï¼Ÿ](https://time.geekbang.org/column/article/722240?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

å¦‚æœä½ ç»™æŸä¸ªæ³›å‹å®ç°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆè¿˜èƒ½ä¸ºå®ƒçš„ä¸€ä¸ªå…·åŒ–ç±»å‹å†å®ç°åŒæ ·çš„æ–¹æ³•å—ï¼Ÿ

#### ç­”æ¡ˆ

â€œä¸ºæ³›å‹å®ç°äº†ä¸€ä¸ªæ–¹æ³•ï¼Œèƒ½å¦å†ä¸ºå…·åŒ–ç±»å‹å®ç°ä¸€ä¸ªåŒåæ–¹æ³•â€ï¼Œå–å†³äºè¿™ä¸ªæ³›å‹èƒ½å¦è¡¨ç¤ºç›¸åº”çš„å…·åŒ–ç±»å‹ã€‚æ¯”å¦‚ä¸ºæ³›å‹ T å’Œ String å®ç°äº†ç›¸åŒçš„æ–¹æ³•ï¼Œç”±äº T æ²¡æœ‰æ–½åŠ ä»»ä½•çº¦æŸï¼Œå®ƒå¯ä»¥ä»£è¡¨ Stringã€‚é‚£ä¹ˆå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¯¹äºå…·åŒ–ç±»å‹ String æ¥è¯´ï¼Œè¦è°ƒç”¨å“ªä¸€ä¸ªå‘¢ï¼Ÿå› æ­¤ä¼šå‡ºç°æ­§ä¹‰ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼šæ–¹æ³•è¢«é‡å¤å®šä¹‰äº†ã€‚

ä½†å¦‚æœç»™æ³›å‹ T æ–½åŠ äº†ä¸€ä¸ª Copy çº¦æŸï¼Œè¦æ±‚ T å¿…é¡»å®ç°äº† Copy traitï¼Œé‚£ä¹ˆå°±ä¸ä¼šæŠ¥é”™äº†ï¼Œå› ä¸ºæ­¤æ—¶ T ä»£è¡¨ä¸äº† Stringï¼Œæ‰€ä»¥è°ƒç”¨æ–¹æ³•ä¸ä¼šå‡ºç°æ­§ä¹‰ã€‚ä½†å¦‚æœå†ä¸º `i32` å®ç°ä¸€ä¸ªåŒåæ–¹æ³•å°±ä¼šæŠ¥é”™äº†ï¼Œå› ä¸º `i32` å®ç°äº† Copyï¼Œå®ƒå¯ä»¥è¢« T è¡¨ç¤ºã€‚

ç­”æ¡ˆæ¥è‡ªå¤æ˜åœ°è§‰

### [08ï½œOptionã€Resultã€è¿­ä»£å™¨åŠå®é™…ç±»å‹ä¸­æ‰€æœ‰æƒé—®é¢˜](https://time.geekbang.org/column/article/722702?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

ä½ å¯ä»¥ç”¨åŒæ ·çš„æ€è·¯å»ç ”ç©¶ä¸€ä¸‹ï¼Œçœ‹çœ‹å¦‚ä½•æ‹¿åˆ° HashMap ä¸­å€¼çš„æ‰€æœ‰æƒã€‚ [https://doc.rust-lang.org/std/collections/struct.HashMap.html](https://doc.rust-lang.org/std/collections/struct.HashMap.html)

#### ç­”æ¡ˆ

HashMapå®ç°äº† `into_iter()`ï¼Œå› æ­¤å¯ä»¥ç”¨forè¯­å¥è·å–å…¶æ‰€æœ‰æƒã€‚

```plain
for (k, v) in myhash { //`myhash` moved due to this implicit call to `.into_iter()`
    // todo:
    // è¿™é‡Œä¼šè·å¾—vçš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”æ¶ˆè€—æ‰myhash
}

println!("{:?}", myhash); //value borrowed here after move

```

ç­”æ¡ˆæ¥è‡ªPEtFiShå’ŒRansang

### [09ï½œåˆè¯†Traitï¼šåè®®çº¦æŸä¸èƒ½åŠ›é…ç½®](https://time.geekbang.org/column/article/723496?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

å¦‚æœä½ å­¦ä¹ æˆ–è€…äº†è§£è¿‡ Javaã€C++ ç­‰é¢å‘å¯¹è±¡è¯­è¨€çš„è¯ï¼Œå¯ä»¥èŠä¸€èŠ trait çš„ä¾èµ–å’Œ OOP ç»§æ‰¿çš„åŒºåˆ«åœ¨å“ªé‡Œã€‚

#### ç­”æ¡ˆ

trait çš„ä¾èµ–ï¼šå°æ˜è¦å¬ä»æ•°å­¦è€å¸ˆï¼Œè¯­æ–‡è€å¸ˆï¼Œè‹±è¯­è€å¸ˆçš„è¯ã€‚è€å¸ˆä¹‹é—´æ˜¯å¹³ç­‰å…³ç³»ï¼Œå¤šä¸ªä¾èµ–å¹³ç­‰ï¼Œæœ€å°ä¾èµ–é€‰æ‹©è‡ªå·±å–œæ¬¢çš„åŠŸèƒ½ã€‚

OOP ç»§æ‰¿ï¼šå°æ˜è¦å¬ä»–çˆ¸ã€ä»–çˆ·çˆ·ã€ä»–æ›¾ç¥–çˆ¶çš„è¯ã€‚ç»§æ‰¿ä¹‹é—´å­˜åœ¨çˆ¶å­å…³ç³»ï¼Œç»§æ‰¿è¿‡æ¥ä¸€å †ç ´å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿè®¸æ ¹æœ¬ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ï¼Œè¿˜è¦è´Ÿé‡å‰è¡Œã€‚

ç­”æ¡ˆæ¥è‡ªä¸‹é›¨å¤©

### [10ï½œå†æ¢Traitï¼šTrait + ç±»å‹ = Rust çš„å¤§è„‘](https://time.geekbang.org/column/article/724776?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

è¯·è°ˆè°ˆåœ¨å‡½æ•°å‚æ•°ä¸­ä¼ å…¥ `&dyn TraitA` ä¸ `Box`Â ä¸¤ç§ç±»å‹çš„åŒºåˆ«ã€‚

#### ç­”æ¡ˆ

Rustç”Ÿå‘½å‘¨æœŸçš„ç‹¬ç‰¹è®¾è®¡ï¼Œå¯¼è‡´äº†è¯¥è¯­è¨€éœ€è¦è®¾è®¡ä¸€äº›å¤„ç†æ–¹å¼åº”å¯¹ç‰¹æ®Šæƒ…å†µï¼Œæ¯”å¦‚ç”Ÿå‘½å‘¨æœŸçš„æ ‡æ³¨ï¼ˆä¸»è¦æ˜¯ç»™ç¼–è¯‘å™¨è¿›è¡Œä»£ç å¤„ç†æ—¶çš„æç¤ºï¼‰ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­åº”è¯¥é¿å…ä¸€äº›é™·å…¥å¤æ‚æƒ…å†µçš„æ–¹å¼ï¼šæ¯”å¦‚ï¼Œä¼ å…¥å‚æ•°éƒ½ç”¨å¼•ç”¨ï¼ˆborrowï¼‰ï¼Œä¼ å‡ºç»“æœéƒ½åº”è¯¥æ˜¯ownerã€‚Rustä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†å¤„ç†å„ç§æƒ…å†µçš„å·¥å…·ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™ç”¨ `&dyn T`ï¼Œä¼ å‡ºç»“æœç”¨ `Box<dyn T>`ã€‚

æ­¤å¤–ï¼Œ `&dyn TraitA` æ²¡æœ‰æ‰€æœ‰æƒï¼Œè€Œ `Box<dyn TraitA>` æœ‰æ‰€æœ‰æƒã€‚ `&dyn TraitA` æ˜¯å€Ÿç”¨ï¼ŒBox ä¼šè½¬ç§»æ‰€æœ‰æƒã€‚

é€šè¿‡ä¸‹é¢çš„ç¨‹åºå¯ä»¥æµ‹è¯•å‡ºæ¥ï¼š

```plain
fn doit3(t1: &dyn TraitA, t2: Box) {
     println!("{:?}", t1);
     println!("{:?}", t2)
 }
fn main() {
     let a = AType;
     let b = BType;
     doit3(&a, Box::new(b));
     println!("{:?}", a);
     println!("{:?}", b);
 }
è¾“å‡ºï¼š
error[E0382]: borrow of moved value: b
   --> examples/trait_object.rs:29:22
    |
 26 |     let b = BType;
    |         - move occurs because b has type BType, which does not implement the Copy trait
 27 |     doit3(&a, Box::new(b));
    |                        - value moved here
 28 |     println!("{:?}", a);
 29 |     println!("{:?}", b);
    |                      ^ value borrowed here after move

```

ç­”æ¡ˆæ¥è‡ªå“„å“„ã€é¸ æ‘©æ™ºå’Œ-Hedon ğŸ­

### [11ï½œå¸¸è§ Trait è§£æï¼šæ ‡å‡†åº“ä¸­çš„å¸¸ç”¨ Trait åº”è¯¥æ€ä¹ˆç”¨ï¼Ÿ](https://time.geekbang.org/column/article/724942?utm_campaign=geektime_search&utm_content=geektime_search&utm_medium=geektime_search&utm_source=geektime_search&utm_term=geektime_search)

#### æ€è€ƒé¢˜

è¯·ä¸¾ä¾‹è¯´æ˜ Deref ä¸ AsRefÂ çš„åŒºåˆ«ã€‚

#### ç­”æ¡ˆ

åœ¨ Rust ä¸­ï¼ŒDeref å’Œ AsRef éƒ½æ˜¯ä¸å¼•ç”¨ç›¸å…³çš„ traitï¼Œå®ƒä»¬å¯ä»¥ä½¿æŸäº›ç±»å‹åœ¨ä½¿ç”¨æ—¶å…·æœ‰ç±»ä¼¼äºæŒ‡é’ˆçš„è¡Œä¸ºï¼Œä½†å®ƒä»¬çš„å…·ä½“ç”¨é€”æœ‰æ‰€ä¸åŒã€‚

**Deref trait é€šå¸¸ä¸æ™ºèƒ½æŒ‡é’ˆä¸€èµ·ä½¿ç”¨**ã€‚å½“æˆ‘ä»¬ç¼–å†™ Rust ä»£ç æ—¶ï¼Œåˆ†é…åœ¨å †ä¸Šçš„å€¼é€šå¸¸ä¸æ˜¯é€šè¿‡æ‹·è´çš„æ–¹å¼ä¼ é€’æˆ–è¿”å›ï¼Œè€Œæ˜¯é€šè¿‡ä½¿ç”¨æŒ‡å‘å®ƒä»¬çš„æŒ‡é’ˆï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰æ¥ä¼ é€’æˆ–è¿”å›ã€‚Deref trait å¯ä»¥å¼ºåˆ¶å°†æ™ºèƒ½æŒ‡é’ˆè½¬æ¢æˆæŒ‡é’ˆï¼Œä»è€Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äº \* æ“ä½œç¬¦è¿™æ ·çš„è§£å¼•ç”¨è¯­æ³•è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„å€¼ã€‚ä¾‹å¦‚ï¼š

```plain
struct MyInt(i32);

impl Deref for MyInt {
    type Target = i32;

    fn deref(&self) -> &Self::Target {
        &self.0
    }
}

fn main() {
    let my_int = MyInt(42);
    assert_eq!(*my_int, 42);
}

```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª `MyInt` ç»“æ„ä½“ï¼Œå®ƒåŒ…å«ä¸€ä¸ª i32 ç±»å‹çš„å€¼ã€‚æˆ‘ä»¬å®ç°äº† Deref traitï¼Œå¹¶æŒ‡å®šäº†ç›®æ ‡ç±»å‹ä¸º i32ã€‚æˆ‘ä»¬åœ¨ `deref` æ–¹æ³•ä¸­è¿”å›äº† `self.0`ï¼Œå³æŒ‡å‘ `MyInt` ä¸­çš„ i32 å€¼çš„å¼•ç”¨ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ `main` å‡½æ•°ä¸­ä½¿ç”¨ `*my_int` è®¿é—®è¿™ä¸ª i32 å€¼ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œ **AsRef trait æ›´åŠ é€šç”¨**ã€‚å®ƒåªæ˜¯å°†ç±»å‹çš„å¼•ç”¨è½¬æ¢ä¸ºå…¶ä»–ç±»å‹çš„å¼•ç”¨ã€‚ä¸€ç§å¸¸è§çš„ç”¨é€”æ˜¯å°†å„ç§å­—ç¬¦ä¸²ç±»å‹ç»Ÿä¸€è½¬æ¢ä¸º&strç±»å‹ã€‚ä¾‹å¦‚ï¼š

```plain
fn do_something<T: AsRef<str>>(input: T) {
    let bytes = input.as_ref().as_bytes();
    // Do something with the bytes...
}

fn main() {
    let my_str = "hello".to_string();
    do_something(my_str);
}

```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª `do_something` å‡½æ•°ï¼Œå®ƒæ¥å—ä»»ä½•å®ç°äº† `AsRef<str>` trait çš„å€¼ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ `as_ref` æ–¹æ³•å°†è¾“å…¥å€¼è½¬æ¢ä¸º `&str` ç±»å‹ï¼Œç„¶åä½¿ç”¨ `as_bytes` æ–¹æ³•å°† `&str` ç±»å‹è½¬æ¢ä¸º `&[u8]` ç±»å‹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å‡½æ•°ä¸­ä½¿ç”¨å­—èŠ‚æ•°ç»„æ“ä½œ `bytes` äº†ã€‚åœ¨ `main` å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªæ‰€æœ‰æƒå­—ç¬¦ä¸²ï¼Œå®ƒåœ¨å‡½æ•°ä¸­ï¼Œä½¿ç”¨ as\_ref() è½¬æ¢æˆäº† `&str` ç±»å‹ã€‚

å¥½äº†ï¼Œä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬ç¬¬ä¸€ç« åŸºç¡€ç¯‡çš„æ€è€ƒé¢˜ä¸ç­”æ¡ˆï¼Œå¸Œæœ›ä½ å¯¹ç…§ç€ç­”æ¡ˆçœ‹ä¸€ä¸‹è‡ªå·±çš„æ€è·¯å¯¹ä¸å¯¹ï¼Œå¦‚æœä½ æœ‰ä¸åŒçš„è§è§£ï¼Œä¹Ÿæ¬¢è¿ä½ åœ¨è¯„è®ºåŒºåˆ†äº«å‡ºæ¥ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼