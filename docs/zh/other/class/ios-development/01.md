# 从 0 到 1 开发一款 iOS App

## 01. 创建第一个 XCode 工程

1. 打开 xcode 软件，选择新建项目，选择 APP 栏目，输入适当的项目信息，然后可以看到初始化后的一个项目
2. 修改`ViewController.m`文件，添加如下内容

```objective-c
// 创建一个简单的 hello world
- (void)viewDidLoad {
  [super viewDidLoad];
  [self.view addSubview:({
    UILabel *label = [[UILabel alloc] init];
    label.text = @"hello world";
    [label sizeToFit];
    label.center = CGPointMake(self.view.frame.size.width/2, self.view.frame.size.height/2);
    label;
  })];
}
@end
```

3. 运行模拟机，你就会看到一个显示`hello world`的界面

## 02. 创建多个`UIView`

> 上一节我们看到一个显示 hello world 的界面，这节我们创建两个 UIView，并注意创建顺序和层级的关系

1. 修改`ViewController.m` 中 `hello world` 的`UILable`界面内容，内容如下

```objective-c
- (void)viewDidLoad {
    [super viewDidLoad];
    // 创建两个子view
    UIView *view = [[UIView alloc] init];
    view.backgroundColor = [UIColor redColor];
    view.frame = CGRectMake(100, 100, 100, 100);
    [self.view addSubview:view];

    UIView *view2 = [[UIView alloc] init];
    view2.backgroundColor = [UIColor greenColor];
    view2.frame = CGRectMake(150, 150, 100, 100);
    [self.view addSubview:view2];
}

@end
```

2. 运行模拟机后，可以看到两个方块，一个红色一个绿色，并且两个元素有重叠部分，且`后创建的元素在上面`

   <img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/132600fea9554117a225c14192e4c6ce~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom: 33%;" />

## 03. UIView 的生命周期

1. UIView 也有很多生命周期，我们创建一个子 TestView 继承 UIView，并再实现其各个生命周期。
2. 创建一个 `view`继承`TestView`,并进行挂载。
3. 在`view`的创建和挂载出，以及`TestView`的各个生命周期处添加断点，然后运行模拟机
4. 内容如下

   ```objective-c
   #import "ViewController.h"

   @interface TestView: UIView
   @end

   @implementation TestView
   -(instancetype )init{
       self = [super init];
       return self;
   }
   - (void)willMoveToSuperview:(nullable UIView *)newSuperview{
       [super willMoveToSuperview:newSuperview]; // 此处 打断点 ，序号为 3
   }
   - (void)didMoveToSuperview{
       [super didMoveToSuperview];// 此处 打断点 ，序号为 4
   }
   - (void)willMoveToWindow:(nullable UIWindow *)newWindow{
       [super willMoveToWindow: newWindow];// 此处 打断点 ，序号为 5
   }
   - (void)didMoveToWindow{
       [super didMoveToWindow];// 此处 打断点 ，序号为 6
   }
   @end

   @interface ViewController()
   @end

   @implementation ViewController
   - (void)viewDidLoad {
       [super viewDidLoad];
       UIView *view = [[TestView alloc] init]; // 此处 打断点 ，序号为 1
       view.backgroundColor = [UIColor redColor];
       view.frame = CGRectMake(100, 100, 100, 100);
       [self.view addSubview:view]; // 此处 打断点 ，序号为 2
   }
   @end
   ```

   5. 运行模拟机可以，可以看到执行顺序：`序号1(创建)`=>`序号2（挂载 addSubview）`=>`序号3（willMoveToSuperview）`=>`序号4（didMoveToSuperview）`=>`序号5（willMoveToWindow）`=>`序号6（didMoveToWindow）`

## 04. UIViewController

### 1. 视图控制器，管理视图 View 层级结构

1. 自身包含 View,可以理解为一个容器

- 管理 View 视图的生命周期
- 响应用户操作
- 和 App 整体交互，视图的切换
- 作为一个 container 管理多个 Controller 和动画

2. ViewController 的生命周期

- init
- viewDidLoad
- viewWillAppear
- viewDidAppear
- viewWillDisappear
- viewDidDisappear
- Dealloc

选择合适的函数处理不同的业务

### 2. 代码示范

1. 修改`ViewController.h`，内容修改如下

   ```objective-c
   #import "ViewController.h"

   @interface TestView: UIView
   @end

   @implementation TestView
   -(instancetype )init{
       self = [super init];
       return self;
   }
   @end

   @interface ViewController()
   @end

   @implementation ViewController

   -(instancetype ) init{
       self = [super init];
       return self;
   }
   - (void)viewWillAppear:(BOOL)animated{
       [super viewWillAppear:animated]; // 这里打断点，序号3
   }

   - (void)viewDidAppear:(BOOL)animated{
       [super viewDidAppear:animated];// 这里打断点，序号4
   }
   // 这里的生命周期在页面消失后才会触发，这里是单页面，无法演示，后续再讲解
   - (void)viewWillDisappear:(BOOL)animated{
       [super viewWillDisappear:animated];
   }
   - (void)viewDidDisappear:(BOOL)animated{
       [super viewDidDisappear:animated];
   }
   - (void)viewDidLoad {
       [super viewDidLoad];

       TestView *view = [[TestView alloc] init]; // 这里打断点，序号1
       view.backgroundColor = [UIColor redColor];
       view.frame = CGRectMake(100, 100, 100, 100);
       [self.view addSubview:view];// 这里打断点，序号2
   }
   @end
   ```

2. 打完断点后，运行模拟器，可以看到执行顺序：`序号1（创建）`=>`序号2（挂载）`=>`序号3（viewWillAppear）`=>`序号4（viewDidAppear）`
3. 注意：`viewWillAppear`时候页面中元素还没有展示出来，展示完成后才触发的`viewDidAppear`

## 05. 实现你的第一个 TabBar 页面

### 1. 通过 UIView 和 UIViewController 的特性搭建 App

- UIView 负责页面内的内容呈现
- 使用基础的 UIViewController 管理多个 UIView
- UIViewController 在管理 UIView 的同时，负责不同的切换

### 2. 常用 App 页面结构分析

#### 1. 单页面展示

- 通过列表展示简介
- 通过较长滚动页面展示内容

#### 2. 多页面管理

- 4 个或者 5 个底部按钮：`UITabBarController`
- 通过 Push 的方式进行页面切换

#### 3. UITabBarController

> UITabBarController 功能就是管理多个 ViewController 切换，通过点击底部对应按钮，选中对应需要展示的 ViewController.
>
> 国内 App 一般展示 4-5 个可选项

<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f99fc7f29f64cd6b87c30b4b2ced060~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom: 33%;" />

#### 4. UITabBar

> 可以包含 多个 UITabBarButton, UITabBarButton 又可以包含 tabBarItem.image、tabBarItem.title

- 按照加入 TabbarController 的顺序展示
- 展示的内容有对应的 ViewController 设置
- 系统负责点击的响应和切换

<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/779767e5f2834fd0b90cd5ff870ad388~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom: 33%;" />

### 3. 实现自己的 TabBar

- 使用系统函数实现

- 相关开源框架和项目

  - 开源 Tabbar/Tabbarcontroller 主要是做了简易的封装+5 个按钮的样式

  1. 完全自己实现
  2. TabBar 上粘贴自定义的 SubView，响应事件调用系统方法

### 4. 代码实现

1. `AppDelegate.m`中进行如下更改，更给`rootViewController`指向

   ```objective-c
   - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
       // Override point for customization after application launch.
       self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
       UITabBarController *tabbarController = [[UITabBarController alloc] init];

       UIViewController *controller1 = [[UIViewController alloc] init];
       controller1.view.backgroundColor = [UIColor redColor];

       UIViewController *controller2 = [[UIViewController alloc] init];
       controller2.view.backgroundColor = [UIColor yellowColor];

       UIViewController *controller3 = [[UIViewController alloc] init];
       controller3.view.backgroundColor = [UIColor greenColor];

       UIViewController *controller4 = [[UIViewController alloc] init];
       controller4.view.backgroundColor = [UIColor lightGrayColor];

       [tabbarController setViewControllers:@[controller1,controller2,controller3,controller4]];

       self.window.rootViewController = tabbarController;
       [self.window makeKeyAndVisible];
       return YES;
   }
   ```

2. 运行模拟机发现报错了，报错信息如下

   ```shell
   terminating with uncaught exception of type NSException
   *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[AppDelegate setWindow:]: unrecognized selector sent to instance 0x6000011d8280'
   ```

3. 解决办法

   - 删除`info.plist` 下的`Application scence Manifest`
   - 删除 `SceneDelegate（.h和.m）`文件
   - 删除`AppDelegate.h`中的`SceneDelegate`回调方法,即如下代码（~~**删掉删掉删掉删掉删掉删掉删掉**~~）

     ```objective-c
     #pragma mark - UISceneSession lifecycle

     - (UISceneConfiguration *)application:(UIApplication *)application configurationForConnectingSceneSession:(UISceneSession *)connectingSceneSession options:(UISceneConnectionOptions *)options{
       ....
     }
     - (void)application:(UIApplication *)application didDiscardSceneSessions:(NSSet<UISceneSession *> *)sceneSessions {
     	...
     }
     ```

   - `AppDelegate.h`里加声明`window`:
     ```objective-c
     @property (nonatomic, strong) UIWindow * window;
     ```

### 代码实现中报错参考文档

[Xcode 11 版本纯代码设置 window.rootviewController](https://www.jianshu.com/p/c30ff97996ce)
