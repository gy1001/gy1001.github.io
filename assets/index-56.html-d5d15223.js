import{_ as t,M as p,p as o,q as e,R as n,t as s,N as c,a1 as r}from"./framework-e8cb8151.js";const i={},l=n("h1",{id:"_56-模块化实践案例二",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_56-模块化实践案例二","aria-hidden":"true"},"#"),s(" 56-模块化实践案例二")],-1),u=n("p",null,"一个页面的内容如何展示，往往需接口请求之后才能完全确认。",-1),k=n("p",null,"因此，大多数页面在默认时，都会展示一个 Loading 提示，或者是骨架展示。等到接口请求完成之后，再切换成想要展示的内容。",-1),d=n("p",null,"这是我们日常开发中最常见的需求。那么在没有 React/Vue 等框架的帮助下，我们如何能够方便快捷的做到展示内容的切换呢？",-1),v=n("h2",{id:"_1-项目准备",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-项目准备","aria-hidden":"true"},"#"),s(" 1-项目准备")],-1),m=n("p",null,"首先，使用 create react app 创建一个项目。",-1),q={href:"https://github.com/yangbo5207/jsCore/tree/master/6.9%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91%E5%AE%9E%E4%BE%8B/zhihunew",target:"_blank",rel:"noopener noreferrer"},g=r(`<p>因为默认的 demo 中，有了自己的 DOM 渲染，因此我们需要清空他们。将 App.tsx 修改为如下即可</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&#39;App&#39;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-请求接口的工具模块" tabindex="-1"><a class="header-anchor" href="#_2-请求接口的工具模块" aria-hidden="true">#</a> 2-请求接口的工具模块</h2><p>我们需要一个类似于 <code>axios.get</code> 或者 <code>$.get</code> 这样的方法，去请求接口。代码封装如下，该方法单独成为一个模块，</p><p>实践中，我们还要根据需求，扩展 post、put、delete 方法</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/request.ts</span>
<span class="token comment">// 简易版，未考虑参数情况，请勿运用于实践</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> get<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>url<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">XHR</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token constant">XHR</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token constant">XHR</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token constant">XHR</span><span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">XHR</span><span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">XHR</span><span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">XHR</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token constant">XHR</span><span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-api-模块" tabindex="-1"><a class="header-anchor" href="#_3-api-模块" aria-hidden="true">#</a> 3-api 模块</h2><p>实践项目中，有许多要从后端请求数据的接口。我们统一封装在一个模块里</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/api.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./request&#39;</span>
<span class="token keyword">import</span> news<span class="token punctuation">,</span> <span class="token punctuation">{</span> Newspaper <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./data&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">newsApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 本来应该如此请求接口，但是由于跨域限制，因此我们这里模拟该接口的行为返回数据 mock</span>
  <span class="token comment">// return get&lt;any&gt;(&#39;https://news-at.zhihu.com/api/4/news/latest&#39;)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span>
    Newspaper <span class="token operator">&gt;</span>
    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>news<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">other1Api</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">url</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">other2Api</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">url</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">other3Api</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">url</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 实践中可能还会有更多 api 请求</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此处特殊的地方：由于跨域的限制，get 请求在开发中并不能请求成功。因此我们使用 mock 的方法模拟请求。</p><blockquote><p>我们可以使用配置本地代理的方式来解决跨域问题。</p></blockquote><p>因此这里会额外弄一个数据来源的模块</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/data.ts</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Story</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">ga_prefix</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">hint</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
  <span class="token literal-property property">image_hue</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">TopStore</span> <span class="token keyword">extends</span> <span class="token class-name">Story</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">image</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ListStore</span> <span class="token keyword">extends</span> <span class="token class-name">Story</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">images</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Newspaper</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">date</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">stories</span><span class="token operator">:</span> ListStore<span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token literal-property property">top_stories</span><span class="token operator">:</span> TopStore<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token literal-property property">news</span><span class="token operator">:</span> Newspaper <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;20210112&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;stories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0xb37b99&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;在儿童教育中该不该运用惩罚？怎么用？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731933&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;鸽子Gezi · 3 分钟阅读&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011207&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic4.zhimg.com/v2-23d60782cb5b0b39698364438a24547b.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731933</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x2f3964&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;中国不同城市的夜景都有哪些特色？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731939&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;星球研究所 · 8 分钟阅读&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011207&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic1.zhimg.com/v2-c99ea0a523f595b142380603b7086a78.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731939</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x0c729e&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;在游戏公司的音频部门工作是一种怎样的体验？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731921&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;腾讯天美工作室群 · 8 分钟阅读&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011207&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic3.zhimg.com/v2-9013f69bfdf8c61b3232c43ee55971cb.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731921</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x241e19&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;如果不得已要熬夜，怎么将熬夜的伤害减到最轻？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731911&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;浩浩耗 · 2 分钟阅读&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011207&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic4.zhimg.com/v2-d327b0dcdabff3ad1121900dd26ec646.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731911</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x342a18&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;哪双球鞋适合春节穿？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731924&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ricki · 6 分钟阅读&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011207&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic2.zhimg.com/v2-388a92dae4d8c9fe3423ef2a02c25f06.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731924</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x959199&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;瞎扯 · 如何正确地吐槽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731914&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;VOL.2569&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011206&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pic1.zhimg.com/v2-6e6a28ec3807dd74a29f4502c5bb25ce.jpg?source=8673f162&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731914</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;top_stories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x45252b&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;作者 / 混乱博物馆&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731891&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://pic1.zhimg.com/v2-ca39463c945a2d8decc21575a42edcf0.jpg?source=8673f162&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;人类可以只吃肉不吃菜吗？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;011107&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731891</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x402d39&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;作者 / Justin Lee&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731821&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://pic2.zhimg.com/v2-41051830be11f2cecb10dad435d67f40.jpg?source=8673f162&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;法国人很浪漫，或许只是一种错误的刻板印象？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;010907&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731821</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x2a301e&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;作者 / 知乎用户&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731797&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://pic1.zhimg.com/v2-20daa7834321aee53f4a87ca2907b596.jpg?source=8673f162&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;接到了不同的 OFFER 应该怎么比较？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;010807&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731797</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x999391&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;作者 / Derrick Zhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731703&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://pic4.zhimg.com/v2-da79a55f96ace676c433a7c5adde99ab.jpg?source=8673f162&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021 年了，你还愿意买 Kindle 吗？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;010607&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731703</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token string-property property">&quot;image_hue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0x172121&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;作者 / 苏澄宇&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://daily.zhihu.com/story/9731647&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://pic2.zhimg.com/v2-ef49f243658edb316fd306be39e2f9be.jpg?source=8673f162&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;野生动物吃鱼不会被刺卡住吗？&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ga_prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;010407&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9731647</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> news<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-页面模块-render-模块" tabindex="-1"><a class="header-anchor" href="#_4-页面模块-render-模块" aria-hidden="true">#</a> 4-页面模块 / render 模块</h2><p>针对某一个功能的处理。此处页面模块的作用，就是请求数据，并且渲染页面。</p><p>首先在 index.html 中，添加一个容器标签，我们会将内容渲染到该容器中。</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>news<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后处理页面逻辑</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/render.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> newsApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./api&#39;</span>

<span class="token keyword">const</span> news <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#news&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>news<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;容器元素不存在&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始值</span>
news<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;数据加载中...&#39;</span>

<span class="token function">newsApi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    &lt;div class=&quot;top-container&quot;&gt;
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>res<span class="token punctuation">.</span>top_stories
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;a class=&quot;item&quot; href=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
          &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>image<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;&quot; /&gt;
          &lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;
        &lt;/a&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    &lt;/div&gt;
  </span><span class="token template-punctuation string">\`</span></span>

  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
    &lt;div class=&quot;list-container&quot;&gt;
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>res<span class="token punctuation">.</span>stories
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;a class=&quot;item&quot; href=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;
          &lt;img src=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>images<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; alt=&quot;&quot; /&gt;
          &lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>item<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;
        &lt;/a&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    &lt;/div&gt;
  </span><span class="token template-punctuation string">\`</span></span>
  news<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>top<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>list<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-最后" tabindex="-1"><a class="header-anchor" href="#_5-最后" aria-hidden="true">#</a> 5-最后</h2><p>最后在入口模块 <code>index.tsx</code> 中，引入 render 模块即可。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/index.tsx</span>
<span class="token keyword">import</span> <span class="token string">&#39;./render&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>一个简单的模块化案例，就这样完成了。</p>`,23);function y(b,h){const a=p("ExternalLinkIcon");return o(),e("div",null,[l,u,k,d,v,m,n("p",null,[s("本文的实例项目地址："),n("a",q,[s("点击这里"),c(a)])]),g])}const w=t(i,[["render",y],["__file","index-56.html.vue"]]);export{w as default};
