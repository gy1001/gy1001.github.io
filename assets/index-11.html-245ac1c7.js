import{_ as t,M as o,p as l,q as c,R as n,t as s,N as e,a1 as p}from"./framework-e8cb8151.js";const i={},r=p('<h1 id="_11-webpack-性能优化-大型前端项目工程化升级实战" tabindex="-1"><a class="header-anchor" href="#_11-webpack-性能优化-大型前端项目工程化升级实战" aria-hidden="true">#</a> 11-Webpack 性能优化: 大型前端项目工程化升级实战</h1><h2 id="_01-webpack-性能优化原理和目标" tabindex="-1"><a class="header-anchor" href="#_01-webpack-性能优化原理和目标" aria-hidden="true">#</a> 01：webpack 性能优化原理和目标</h2><h3 id="构建性能优化方法" tabindex="-1"><a class="header-anchor" href="#构建性能优化方法" aria-hidden="true">#</a> 构建性能优化方法</h3><ul><li>查找并诊断性能瓶颈 <ul><li>构建速度分析：影响构建性能和开发效率</li><li>构建体积分析：影响页面性能</li></ul></li><li>构建性能优化常用方法 <ul><li>通过多进程加快构建速度</li><li>通过分包减少构建目标容量</li><li>减少构建目标加快构建速度</li></ul></li></ul><h2 id="_02-深入分析构建速度测量插件-speed-measure-webpack-plugin" tabindex="-1"><a class="header-anchor" href="#_02-深入分析构建速度测量插件-speed-measure-webpack-plugin" aria-hidden="true">#</a> 02：深入分析构建速度测量插件 speed-measure-webpack-plugin</h2><h3 id="构建速度分析-speed-measure-webpack-plugin" tabindex="-1"><a class="header-anchor" href="#构建速度分析-speed-measure-webpack-plugin" aria-hidden="true">#</a> 构建速度分析 speed-measure-webpack-plugin</h3>',6),u=n("div",{class:"language-npm line-numbers-mode","data-ext":"npm"},[n("pre",{class:"language-npm"},[n("code",null,`speed-measure-webpack-plugin
`)]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"})])],-1),d={href:"https://github.com/stephencookdev/speed-measure-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},k=p(`<p>使用方式如下</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev speed<span class="token operator">-</span>measure<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin

<span class="token comment">// vue.config.js</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> SpeedMeasuurePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;speed-measure-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasuurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.scss&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        <span class="token literal-property property">assets</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/assets&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        <span class="token literal-property property">components</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/components&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新运行<code>npm run dev</code>可以大概看到如下结果</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>SMP  ⏱
General output <span class="token function">time</span> took <span class="token number">2.089</span> secs

 SMP  ⏱  Loaders
modules with no loaders took <span class="token number">1.4</span> secs
  module count <span class="token operator">=</span> <span class="token number">101</span>
_css-loader@6.7.3@css-loader, and
_vue-loader@17.0.1@vue-loader, and
_postcss-loader@6.2.1@postcss-loader, and
_sass-loader@13.2.2@sass-loader, and
_vue-loader@17.0.1@vue-loader took <span class="token number">1.16</span> secs
  module count <span class="token operator">=</span> <span class="token number">54</span>
_vue-loader@17.0.1@vue-loader took <span class="token number">0.888</span> secs
  module count <span class="token operator">=</span> <span class="token number">275</span>
_css-loader@6.7.3@css-loader, and
_postcss-loader@6.2.1@postcss-loader took <span class="token number">0.299</span> secs
  module count <span class="token operator">=</span> <span class="token number">1</span>
_vue-loader@17.0.1@vue-loader, and
_vue-style-loader@4.1.3@vue-style-loader, and
_css-loader@6.7.3@css-loader, and
_postcss-loader@6.2.1@postcss-loader, and
_sass-loader@13.2.2@sass-loader, and
_vue-loader@17.0.1@vue-loader took <span class="token number">0.06</span> secs
  module count <span class="token operator">=</span> <span class="token number">108</span>
_html-webpack-plugin@5.5.0@html-webpack-plugin took <span class="token number">0.024</span> secs
  module count <span class="token operator">=</span> <span class="token number">1</span>
_vue-style-loader@4.1.3@vue-style-loader, and
_css-loader@6.7.3@css-loader, and
_postcss-loader@6.2.1@postcss-loader took <span class="token number">0</span> secs
  module count <span class="token operator">=</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面说一些他得配置项目</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasurePlugin</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

options<span class="token punctuation">.</span>disable<span class="token operator">:</span> Type<span class="token operator">:</span> Boolean Default<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">,</span>是否关闭插件，默认是 <span class="token boolean">false</span>
options<span class="token punctuation">.</span>outputFormat Type<span class="token operator">:</span> String<span class="token operator">|</span>Function Default<span class="token operator">:</span> <span class="token string">&quot;human&quot;</span> 输出格式 json<span class="token operator">||</span> human <span class="token operator">||</span> humanVerbose <span class="token operator">||</span> Function
options<span class="token punctuation">.</span>outputTarget<span class="token operator">:</span> Type<span class="token operator">:</span> String<span class="token operator">|</span>FunctionDefault<span class="token operator">:</span> console<span class="token punctuation">.</span>log
<span class="token operator">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_03-深入分析构建体积检测插件-webpack-bundle-analyzer" tabindex="-1"><a class="header-anchor" href="#_03-深入分析构建体积检测插件-webpack-bundle-analyzer" aria-hidden="true">#</a> 03：深入分析构建体积检测插件 webpack-bundle-analyzer</h2><h3 id="构建体积分析-webpck-bundle-analyzer" tabindex="-1"><a class="header-anchor" href="#构建体积分析-webpck-bundle-analyzer" aria-hidden="true">#</a> 构建体积分析：webpck-bundle-analyzer</h3>`,8),v={href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"},m=p(`<div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>npm install --save-dev webpack-bundle-analyzer

const BundleAnalyzerPlugin = require(&#39;webpack-bundle-analyzer&#39;).BundleAnalyzerPlugin;
module.exports = <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    new BundleAnalyzerPlugin()
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>npm run dev</code>执行后会自动打开<code>http://127.0.0.1:8888/</code>即可看到打包的一个情况</p><h2 id="_04-构建性能优化之多进程-thread-loader" tabindex="-1"><a class="header-anchor" href="#_04-构建性能优化之多进程-thread-loader" aria-hidden="true">#</a> 04：构建性能优化之多进程 thread-loader</h2><h3 id="多进程-多实例-thread-loader" tabindex="-1"><a class="header-anchor" href="#多进程-多实例-thread-loader" aria-hidden="true">#</a> 多进程/多实例 thread-loader</h3>`,4),b={href:"https://github.com/webpack-contrib/thread-loader",target:"_blank",rel:"noopener noreferrer"},g={href:"https://www.webpackjs.com/loaders/thread-loader/",target:"_blank",rel:"noopener noreferrer"},h=p(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>npm install thread<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// webpack.base.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;thread-loader&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">workers</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
     				<span class="token comment">// {</span>
            <span class="token comment">//   loader: &quot;babel-loader&quot;,</span>
            <span class="token comment">//   options: {</span>
            <span class="token comment">//     presets: [&quot;@babel/preset-env&quot;],</span>
            <span class="token comment">//     plugins: [&quot;@babel/plugin-transform-runtime&quot;],</span>
            <span class="token comment">//   },</span>
            <span class="token comment">// },</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然还有其他的可选方案</p><ul><li>parallel-webpack</li><li>HappyPack</li></ul><p>但是由于 happyPack 原作者对 js 的兴趣逐渐丢失，所以之后维护很少，webpack4 之后推荐使用 thread-loader</p>`,4),y={id:"vue-cli-之-parallel-https-cli-vuejs-org-zh-config-parallel",tabindex:"-1"},f=n("a",{class:"header-anchor",href:"#vue-cli-之-parallel-https-cli-vuejs-org-zh-config-parallel","aria-hidden":"true"},"#",-1),w={href:"https://cli.vuejs.org/zh/config/#parallel",target:"_blank",rel:"noopener noreferrer"},_=n("p",null,"对于 vue-cli，官方有一个配置选项",-1),x={id:"parallel",tabindex:"-1"},q=n("a",{class:"header-anchor",href:"#parallel","aria-hidden":"true"},"#",-1),j={href:"https://cli.vuejs.org/zh/config/#parallel",target:"_blank",rel:"noopener noreferrer"},P=n("ul",null,[n("li",null,[n("p",null,[s("Type: "),n("code",null,"boolean")])]),n("li",null,[n("p",null,[s("Default: "),n("code",null,"require('os').cpus().length > 1")]),n("p",null,[s("是否为 Babel 或 TypeScript 使用 "),n("code",null,"thread-loader"),s("。该选项在系统的 CPU 有多于一个内核时自动启用，仅作用于生产构建。")])])],-1),z=p(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// parallel 选项</span>
  <span class="token literal-property property">parallel</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.vue&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.less&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.css&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.scss&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./src&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        <span class="token literal-property property">assets</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./src/assets&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        <span class="token literal-property property">components</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./src/components&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">analyzerMode</span><span class="token operator">:</span> <span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 不启动展示打包报告的http服务器</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_05【精华】webpack5-分包策略详解" tabindex="-1"><a class="header-anchor" href="#_05【精华】webpack5-分包策略详解" aria-hidden="true">#</a> 05【精华】webpack5 分包策略详解</h2><h3 id="分包-dllplugin-dllreferenceplugin" tabindex="-1"><a class="header-anchor" href="#分包-dllplugin-dllreferenceplugin" aria-hidden="true">#</a> 分包 DllPlugin &amp; DllReferencePlugin</h3><blockquote><p>对于变化几率很小的一些第三方包，其实没有必要 build 的时候都要打包一次，可以把这些第三方包单独抽离出来，提前打包好。webpack 本身是要体现出模块间的关系，当我们将一些包抽离出来后，维护之前的依赖关系就需要 mainfest.json 这个文件。将 vue vue-loader vuex 等基础包和业务包打包成一个文件，使用 DllPlugin 进行分包，DllReferencePlugin 对 mainfest.json 引用。mainfest.json 是对分离出来的包的描述</p></blockquote><p>分包的具体步骤</p><ul><li>分包：定义 webpack.dll.config.js,使用 DllPlugin 配置分包，定义 scripts 命令，执行命令，完成分包</li><li>排除分包：在 vue.config.js 中，使用 DllReferecePlugin 引用 mainfest 文件排除分包</li><li>拷贝 dll: 将 dll 拷贝至项目目录下</li><li>引用 dll：使用 add-asset-html-webpack-plugin 引用分包文件</li></ul><h4 id="_1-配置分包" tabindex="-1"><a class="header-anchor" href="#_1-配置分包" aria-hidden="true">#</a> 1. 配置分包</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// build/weback.dll.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> dllPath <span class="token operator">=</span> <span class="token string">&#39;../dll&#39;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">vue</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;vue&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;vue-router&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;showdown&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;better-scroll&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dllPath<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].dll.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span> <span class="token string">&#39;[name]_[fullhash]&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dllPath<span class="token punctuation">,</span> <span class="token string">&#39;[name]-manifest.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;[name]_[fullhash]&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">context</span><span class="token operator">:</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里需要安装<code>webpack webpack-cli</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接下来在<code>package.json</code>中增加打包命令</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;dll&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config ./build/webpack.dll.config.js&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行<code>npm run dll</code>命令，就可以看到产生了<code>dll/vue-mainfetst.json</code>、<code>dll/vue.dll.js</code>、<code>vue.dll.js.LICENSE.txt.</code>文件</p><h4 id="_2-排除分包" tabindex="-1"><a class="header-anchor" href="#_2-排除分包" aria-hidden="true">#</a> 2. 排除分包</h4><p>接下来在<code>webpack.config.js</code>中引入 dll 文件进行使用</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DllReferencePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">context</span><span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
        <span class="token literal-property property">manifest</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./dll/vue-manifest.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-拷贝-dll" tabindex="-1"><a class="header-anchor" href="#_3-拷贝-dll" aria-hidden="true">#</a> 3. 拷贝 dll</h4><ol><li><p>这里我们使用一个插件<code>copy-webpack-plugin</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> copy-webpack-plugin <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>配置文件中引入插件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;copy-webpack-plugin&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">patterns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">from</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./dll/vue.dll.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">to</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./dist/js/vue.dll.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>再次执行<code>npm run build</code>命令</p></li></ol><h4 id="_4-引用-dll" tabindex="-1"><a class="header-anchor" href="#_4-引用-dll" aria-hidden="true">#</a> 4. 引用 dll</h4><ol><li><p>安装插件<code>add-asset-html-webpack-plugin</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> add-asset-html-webpack-plugin <span class="token parameter variable">-D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>配置文件中引入该插件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>

<span class="token keyword">const</span> AddAssetHtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;add-asset-html-webpack-plugin&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 注意这里我们需要关闭 SpeedMeasuurePlugin 插件，否则引用不成功</span>
<span class="token keyword">const</span> smp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpeedMeasuurePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">disable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">AddAssetHtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">filepath</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./dll/vue.dll.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>其实在这里我们用<code>add-asset-html-webpack-plugin</code>引用这个<code>vue.dll.js</code>时，它会帮助我们进行拷贝到 dist 目录下</p></li><li><p>所以我们不需要进行 复制 dll 文件，在配置文件中删除 copy-webpack-plugin 的使用即可，整体下来配置文件 <code>vue.config.js</code>内容如下</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code>var path = require(<span class="token string">&quot;path&quot;</span>);
const SpeedMeasuurePlugin = require(<span class="token string">&quot;speed-measure-webpack-plugin&quot;</span>);
const <span class="token punctuation">{</span> DllReferencePlugin <span class="token punctuation">}</span> = require(<span class="token string">&quot;webpack&quot;</span>);
const smp = new SpeedMeasuurePlugin(<span class="token punctuation">{</span>
  disable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>);
<span class="token comment">// const CopyWebpackPlugin = require(&quot;copy-webpack-plugin&quot;);</span>
const BundleAnalyzerPlugin = require(<span class="token string">&quot;webpack-bundle-analyzer&quot;</span>).BundleAnalyzerPlugin;
const AddAssetHtmlWebpackPlugin = require(<span class="token string">&quot;add-asset-html-webpack-plugin&quot;</span>);
module.exports = <span class="token punctuation">{</span>
  parallel<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  configureWebpack<span class="token operator">:</span> smp.wrap(<span class="token punctuation">{</span>
    resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
      extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.less&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.scss&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      alias<span class="token operator">:</span> <span class="token punctuation">{</span>
        src<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src&quot;</span>)<span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        assets<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/assets&quot;</span>)<span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
        components<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./src/components&quot;</span>)<span class="token punctuation">,</span> <span class="token comment">// 注意这里路径有所更改</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
      new BundleAnalyzerPlugin(<span class="token punctuation">{</span>
        analyzerMode<span class="token operator">:</span> <span class="token string">&quot;disabled&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 不启动展示打包报告的http服务器</span>
      <span class="token punctuation">}</span>)<span class="token punctuation">,</span>
      new DllReferencePlugin(<span class="token punctuation">{</span>
        context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
        manifest<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./dll/vue-manifest.json&quot;</span>)<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>)<span class="token punctuation">,</span>
      <span class="token comment">// new CopyWebpackPlugin({</span>
      <span class="token comment">//   patterns: [</span>
      <span class="token comment">//     {</span>
      <span class="token comment">//       from: path.resolve(__dirname, &quot;./dll/vue.dll.js&quot;),</span>
      <span class="token comment">//       to: path.resolve(__dirname, &quot;./dist/js/vue.dll.js&quot;),</span>
      <span class="token comment">//     },</span>
      <span class="token comment">//   ],</span>
      <span class="token comment">// }),</span>
      new AddAssetHtmlWebpackPlugin(<span class="token punctuation">{</span>
        filepath<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./dll/vue.dll.js&quot;</span>)<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>)<span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>)<span class="token punctuation">,</span>
<span class="token punctuation">}</span>;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>重新运行<code>npm run build</code>,查看<code>dist/index.html</code>，可以看到页面中引用了<code>dll</code>文件</p></li></ol><h2 id="_06-分包文件拷贝和模板的自动引用" tabindex="-1"><a class="header-anchor" href="#_06-分包文件拷贝和模板的自动引用" aria-hidden="true">#</a> 06：分包文件拷贝和模板的自动引用</h2><p>上述步骤已经包含此节内容</p><h2 id="_07-利用-webpack5-cache-特性大幅提升构建性能" tabindex="-1"><a class="header-anchor" href="#_07-利用-webpack5-cache-特性大幅提升构建性能" aria-hidden="true">#</a> 07：利用 webpack5 cache 特性大幅提升构建性能</h2><h3 id="利用缓存提升二次构建速度" tabindex="-1"><a class="header-anchor" href="#利用缓存提升二次构建速度" aria-hidden="true">#</a> 利用缓存提升二次构建速度</h3><p>cache 默认在 node_modules/.cache/terser-plugin 文件下，通过 SHA 或者 base64 编码之前的文件处理结果，并保存文件映射关系，方便下一次处理文件时可以查看之前同文件（同内容）是否有可用缓存，默认存放在内存中，可以修改将缓存存放在硬盘中</p><p>背景：webpack4 在运行时是有缓存的，只不过缓存只存在于内存中。所以，一旦 webpack 的运行程序被关闭，这些缓存就丢失了。这就导致我们 npm run start/build 的时候根本无缓存可用，而在 webpack5 中，cache 配置了除了原本的 true 和 false 外，还增加了许多自配置项。可以将缓存文件存储在硬盘中</p><ul><li><p>type: 缓存类型。值为 memory 或者 filesystem, 分别代表基于内存的临时缓存，以及基于文件系统的持久化缓存。在选择 filesystem 的情况下，下面介绍的其他属性生效</p></li><li><p>cacheDirectory: 缓存目录。默认目录为 node_modules/.cache/webpack</p></li><li><p>name: 缓存名称。同时也是 cacheDirectory 中的子目录命名，默认值为 webpack 的 \${config.name}-\${config.mode} 比如：default-production</p></li><li><p>cacheLocation: 缓存真正的存放地址。默认使用的是上述两个属性的组合：</p><p>path.resolve(cache.cacheDirectory, cache.name) 该属性在赋值情况下将忽略上面的 cacheDirectory 和 name 属性</p></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;filesystem&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">cacheDirectory</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;./node_modules/.temp_cache&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28),D={href:"https://webpack.docschina.org/configuration/cache/#root",target:"_blank",rel:"noopener noreferrer"},S=p(`<h2 id="_08-image-webpack-loader-实现图片-5-倍压缩" tabindex="-1"><a class="header-anchor" href="#_08-image-webpack-loader-实现图片-5-倍压缩" aria-hidden="true">#</a> 08：image-webpack-loader 实现图片 5 倍压缩</h2><h3 id="减少构建目标" tabindex="-1"><a class="header-anchor" href="#减少构建目标" aria-hidden="true">#</a> 减少构建目标</h3><p>背景：当我们使用 loader 对项目进行编译的使用，webpack 是对我们整个项目进行处理的，这里也包括 node_modules 中的文件，这样会增加我们构建项目所消耗的时间，有没有办法可以跳过 node_modules 文件的处理呢，其实这个是有的，module/rules 中的 test、include、exclude 都是针对处理当前的 rule 的 loader 做范围限制的，loader 会针对依赖图中的所有 modules 进行匹配逻辑，如果匹配了，则用当前 loader 进行处理。在使用 loader 时可以通过 test、include、exclude 三个配置项来命中 Loader 要应用规则的文件，为了尽可能少的让文件被 Loader 处理，可以通过 include 去命中只有哪些文件需要被整理</p><ul><li>exclude: 指定要排除的文件</li><li>inclue: 指定要包含的文件</li><li>exclude 优先级高于 include,在 include 和 exclude 中使用绝对路径数组，尽量避免 exclude,而更倾向于使用 include</li><li>使用 include 和 exclude 指定需要处理的文件，忽略不需要处理的文件</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(gif|png|jpe?g|svg|webp)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="图片压缩" tabindex="-1"><a class="header-anchor" href="#图片压缩" aria-hidden="true">#</a> 图片压缩</h3><p>背景：vue-cli 中已经默认帮我们做了很多优化处理，包括静态资源输出、样式处理、代码分割等等，我们需要自己手动配置的事情更少了，而图片压缩处理就是其中的一件，vue 项目中的图片文件过大，会导致打包体积增大，需要将大文件的图片进行压缩从而缩小打包体积。</p><h4 id="image-webpack-loader-已不更新" tabindex="-1"><a class="header-anchor" href="#image-webpack-loader-已不更新" aria-hidden="true">#</a> image-webpack-loader（已不更新）</h4>`,8),W={href:"https://github.com/tcoopman/image-webpack-loader",target:"_blank",rel:"noopener noreferrer"},A=n("p",null,"注意：安装 image-webpack-loader 之后打包的项目可能会遇到 Cannot find module image-gifsicle 报错，需要在 package.json 中 增加 image-gifsicle 然后在 node_modules 中删除 image-webpack-loader 后重新安装 cnpm install image-webpack-loader",-1),M={href:"https://blog.csdn.net/weixin_57605398/article/details/121944815",target:"_blank",rel:"noopener noreferrer"},C=p(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>npm install image<span class="token operator">-</span>webpack<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(gif|png|jpe?g|svg)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;image-webpack-loader&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">mozjpeg</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">progressive</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token comment">// optipng.enabled: false will disable optipng</span>
              <span class="token literal-property property">optipng</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">enabled</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token literal-property property">pngquant</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0.65</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">speed</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token literal-property property">gifsicle</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">interlaced</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token comment">// the webp option will enable WEBP</span>
              <span class="token literal-property property">webp</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">quality</span><span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行<code>npm run build</code>,新版本中的运行保如下错误</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> Failed to compile with <span class="token number">1</span> error                                  <span class="token number">13</span>:53:35

 error  <span class="token keyword">in</span> ./src/images/activity.png

Syntax Error: Error


 ERROR  HookWebpackError: Cannot <span class="token builtin class-name">read</span> properties of undefined <span class="token punctuation">(</span>reading <span class="token string">&#39;toString&#39;</span><span class="token punctuation">)</span>
HookWebpackError: Cannot <span class="token builtin class-name">read</span> properties of undefined <span class="token punctuation">(</span>reading <span class="token string">&#39;toString&#39;</span><span class="token punctuation">)</span>
    at /Users/gaoyuan/Downloads/vue2-elm-master/node_modules/.store/webpack@5.79.0/node_modules/webpack/lib/HookWebpackError.js:65:13
    at <span class="token builtin class-name">eval</span> <span class="token punctuation">(</span>eval at create <span class="token punctuation">(</span>/Users/gaoyuan/Downloads/vue2-elm-master/node_modules/.store/tapable@2.2.1/node_modules/tapable/lib/HookCodeFactory.js:33:10<span class="token punctuation">)</span>, <span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span>:38:1<span class="token punctuation">)</span>
-- inner error --
TypeError: Cannot <span class="token builtin class-name">read</span> properties of undefined <span class="token punctuation">(</span>reading <span class="token string">&#39;toString&#39;</span><span class="token punctuation">)</span>
    at /Users/gaoyuan/Downloads/vue2-elm-master/node_modules/.store/webpack@5.79.0/node_modules/webpack/lib/cache/PackFileCacheStrategy.js:1217:53
    at async Promise.all <span class="token punctuation">(</span>index <span class="token number">62</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>暂时没有找到解决方案</p><h4 id="目前推荐使用-image-minimizer-webpack-plugin" tabindex="-1"><a class="header-anchor" href="#目前推荐使用-image-minimizer-webpack-plugin" aria-hidden="true">#</a> 目前推荐使用：image-minimizer-webpack-plugin</h4>`,5),B={href:"https://www.webpackjs.com/plugins/image-minimizer-webpack-plugin/",target:"_blank",rel:"noopener noreferrer"},E=p(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> image-minimizer-webpack-plugin imagemin --save-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>官方文档：图片有两种压缩方式</p>`,2),H={href:"https://en.wikipedia.org/wiki/Lossless_compression",target:"_blank",rel:"noopener noreferrer"},R={href:"https://en.wikipedia.org/wiki/Lossy_compression",target:"_blank",rel:"noopener noreferrer"},L=p(`<p><strong>Recommended imagemin plugins for lossless optimization</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> imagemin-gifsicle imagemin-jpegtran imagemin-optipng imagemin-svgo --save-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>Recommended imagemin plugins for lossy optimization</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo --save-dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
<span class="token keyword">const</span> ImageMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;image-minimizer-webpack-plugin&#39;</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.(jpe?g|png|gif|svg)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;asset&#39;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">ImageMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">implementation</span><span class="token operator">:</span> ImageMinimizerPlugin<span class="token punctuation">.</span>imageminMinify<span class="token punctuation">,</span>
            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">[</span><span class="token string">&#39;gifsicle&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">interlaced</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token string">&#39;jpegtran&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">progressive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token string">&#39;optipng&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">optimizationLevel</span><span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token comment">// Svgo configuration here https://github.com/svg/svgo#configuration</span>
                <span class="token punctuation">[</span>
                  <span class="token string">&#39;svgo&#39;</span><span class="token punctuation">,</span>
                  <span class="token punctuation">{</span>
                    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                      <span class="token punctuation">{</span>
                        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;preset-default&#39;</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                          <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                            <span class="token literal-property property">removeViewBox</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            <span class="token literal-property property">addAttributesToSVGElement</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                              <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                                <span class="token literal-property property">attributes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                                  <span class="token punctuation">{</span> <span class="token literal-property property">xmlns</span><span class="token operator">:</span> <span class="token string">&#39;http://www.w3.org/2000/svg&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                              <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                          <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                  <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新运行<code>npm run build</code>可以最终看到<code>dist</code>目录下, <code>activity.xxx.png</code>由最开始的 300 多 k 减少为 181kb 左右</p><h2 id="_09-purgecss-webpack-plugin-优化-css-体积" tabindex="-1"><a class="header-anchor" href="#_09-purgecss-webpack-plugin-优化-css-体积" aria-hidden="true">#</a> 09：purgecss-webpack-plugin 优化 css 体积</h2>`,7),T={href:"https://github.com/FullHuman/purgecss/tree/main/packages/purgecss-webpack-plugin",target:"_blank",rel:"noopener noreferrer"},F=p(`<p>背景：一个项目经过长期的迭代更新，可能会产生一些无用的 css 样式更新，如果将这些无用的样式文件进行打包会增加项目体积，如果使用人工删除的方式会增加工作量，css 能不能像 js 那样通过 tree shaking 的方式将没有使用到的样式文件进行删除呢？purgecss-webpack-plugin 就是帮我们把项目中一些没有使用过的代码删除，减少项目体积的插件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>npm install purgecss<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin glob <span class="token operator">-</span><span class="token constant">D</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> PurgeCSSPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;purgecss-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;glob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PATHS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">src</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> smp<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span>
      <span class="token keyword">new</span> <span class="token class-name">PurgeCSSPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">paths</span><span class="token operator">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">PATHS</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">nodir</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重新打包<code>npm run build</code>可以看到 css 文件夹使用插件之前为 309k 左右，使用插件后，内部多了一些<code>xxx.css.map</code>，其他的<code>css</code>文件总大小为 12kb 左右</p>`,3);function V(I,$){const a=o("ExternalLinkIcon");return l(),c("div",null,[r,n("blockquote",null,[u,n("p",null,[n("a",d,[s("https://github.com/stephencookdev/speed-measure-webpack-plugin"),e(a)])])]),k,n("blockquote",null,[n("p",null,[n("a",v,[s("https://github.com/webpack-contrib/webpack-bundle-analyzer"),e(a)])])]),m,n("blockquote",null,[n("p",null,[n("a",b,[s("thread-loader:https://github.com/webpack-contrib/thread-loader"),e(a)])]),n("p",null,[n("a",g,[s("webpack 之 thread-loader:https://www.webpackjs.com/loaders/thread-loader/"),e(a)])])]),h,n("h4",y,[f,s(),n("a",w,[s("Vue-cli 之 parallel：https://cli.vuejs.org/zh/config/#parallel"),e(a)])]),_,n("blockquote",null,[n("h3",x,[q,s(),n("a",j,[s("parallel"),e(a)])]),P]),z,n("p",null,[n("a",D,[s("Cache 官方文档: https://webpack.docschina.org/configuration/cache/#root"),e(a)])]),S,n("p",null,[n("a",W,[s("image-webpack-loader 已归档不再更新:https://github.com/tcoopman/image-webpack-loader"),e(a)])]),A,n("p",null,[s("参考文档："),n("a",M,[s("https://blog.csdn.net/weixin_57605398/article/details/121944815"),e(a)])]),C,n("p",null,[n("a",B,[s("建议使用 ImageMinimizerWebpackPlugin:https://www.webpackjs.com/plugins/image-minimizer-webpack-plugin/"),e(a)])]),E,n("ol",null,[n("li",null,[n("a",H,[s("Lossless"),e(a)]),s(" (without loss of quality).")]),n("li",null,[n("a",R,[s("Lossy"),e(a)]),s(" (with loss of quality).")])]),L,n("p",null,[n("a",T,[s("purgecss-webpack-plugin:https://github.com/FullHuman/purgecss/tree/main/packages/purgecss-webpack-plugin"),e(a)])]),F])}const U=t(i,[["render",V],["__file","index-11.html.vue"]]);export{U as default};
